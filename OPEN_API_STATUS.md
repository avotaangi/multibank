# –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Open API

## üîó –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤–Ω–µ—à–Ω–∏–µ Open API

### 1. **Open Banking API** (–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ API)
**–ë–∞–∑–æ–≤—ã–µ URL:**
- **VBank**: `https://vbank.open.bankingapi.ru`
- **ABank**: `https://abank.open.bankingapi.ru`
- **SBank**: `https://sbank.open.bankingapi.ru`

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/auth/bank-token`)
- ‚úÖ –°—á–µ—Ç–∞ (`/accounts`)
- ‚úÖ –ë–∞–ª–∞–Ω—Å—ã (`/accounts/{account_id}/balances`)
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`/accounts/{account_id}/transactions`)
- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ (`/payments`)
- ‚úÖ –°–æ–≥–ª–∞—Å–∏—è –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ —Å—á–µ—Ç–∞–º (`/account-consents`)
- ‚úÖ –°–æ–≥–ª–∞—Å–∏—è –Ω–∞ –ø–ª–∞—Ç–µ–∂–∏ (`/payment-consents`)
- ‚úÖ –ü—Ä–æ–¥—É–∫—Ç—ã (`/products`)
- ‚úÖ –î–æ–≥–æ–≤–æ—Ä—ã —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ (`/product-agreements`)
- ‚úÖ –°–æ–≥–ª–∞—Å–∏—è –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞–º–∏ (`/product-agreement-consents`)

**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
- ‚úÖ `bankingClient.js` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–Ω–∫–∞–º–∏
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `server/src/routes/`
- ‚ùå **–ù–ï –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ `server/src/index.js`**: `consents`, `payments`, `products`

---

### 2. **Rewards API** (–ë–æ–Ω—É—Å—ã –∏ –Ω–∞–≥—Ä–∞–¥—ã)
**–ë–∞–∑–æ–≤—ã–π URL:** `https://api.bankingapi.ru/api/rb/rewardsPay/hackathon/v1`

**Endpoints:**
- ‚úÖ `GET /cards/accounts/external/{externalAccountID}/rewards/balance` - –±–∞–ª–∞–Ω—Å –±–æ–Ω—É—Å–æ–≤
- ‚úÖ `POST /cards/accounts/external/{externalAccountID}/rewards/redemption` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤

**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
- ‚úÖ `server/src/routes/rewards.js` - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚úÖ `server/src/index.js` - –ø–æ–¥–∫–ª—é—á–µ–Ω–æ (`app.use('/api/rewards', rewardsRoutes)`)
- ‚úÖ Frontend API: `rewardsAPI` –≤ `client/src/services/api.js`

---

## üìã –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã Backend

### ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –≤ `server/src/index.js`:
1. `/api/auth` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. `/api/users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
3. `/api/accounts` - —Å—á–µ—Ç–∞ (MongoDB + —á–∞—Å—Ç–∏—á–Ω–æ Open Banking API)
4. `/api/transactions` - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
5. `/api/telegram` - Telegram WebApp
6. `/api/rewards` - –±–æ–Ω—É—Å—ã (Rewards API)

### ‚ùå –ù–ï –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –≤ `server/src/index.js` (–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã):
1. `/api/consents` - —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ —Å—á–µ—Ç–∞–º/–ø–ª–∞—Ç–µ–∂–∞–º/–ø—Ä–æ–¥—É–∫—Ç–∞–º
2. `/api/payments` - –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ Open Banking API
3. `/api/products` - –ø—Ä–æ–¥—É–∫—Ç—ã –∏ –¥–æ–≥–æ–≤–æ—Ä—ã

---

## üîß Frontend API –º–µ—Ç–æ–¥—ã

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `client/src/services/api.js`:
- `authAPI` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `userAPI` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `accountAPI` - —Å—á–µ—Ç–∞ (—Ç–æ–ª—å–∫–æ MongoDB)
- `transactionAPI` - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `paymentAPI` - –ø–ª–∞—Ç–µ–∂–∏
- `telegramAPI` - Telegram
- `rewardsAPI` - –±–æ–Ω—É—Å—ã

### ‚ùå –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ Frontend:
- `consentsAPI` - —á–∞—Å—Ç–∏—á–Ω–æ (–µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `getConsent`, `createConsent`, `deleteConsent` –¥–ª—è accounts)
- `productsAPI` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- `bankingAPI` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –±–∞–Ω–∫–æ–≤)

---

## üéØ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –∫ backend
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å `consentsRoutes` –∫ `server/src/index.js`
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å `paymentsRoutes` –∫ `server/src/index.js`
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å `productsRoutes` –∫ `server/src/index.js`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –î–æ–±–∞–≤–∏—Ç—å Frontend API –º–µ—Ç–æ–¥—ã
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω—ã–π `consentsAPI` (–¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–≥–ª–∞—Å–∏–π)
2. –î–æ–±–∞–≤–∏—Ç—å `productsAPI` (–ø—Ä–æ–¥—É–∫—Ç—ã, –¥–æ–≥–æ–≤–æ—Ä—ã)
3. –î–æ–±–∞–≤–∏—Ç—å `bankingAPI` (—Ç–æ–∫–µ–Ω—ã –±–∞–Ω–∫–æ–≤, —Å–ø–∏—Å–æ–∫ –±–∞–Ω–∫–æ–≤)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
1. –°–æ–∑–¥–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ Telegram User ID ‚Üí client_id (team096-{0..9})
2. –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –±–∞–Ω–∫–æ–≤ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π client_id –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- `client_id` —Å–µ–π—á–∞—Å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ Telegram User ID: `team096-${telegramUserId % 10}`
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –ú–∞—Ä—à—Ä—É—Ç—ã `consents`, `payments`, `products` –∏—Å–ø–æ–ª—å–∑—É—é—Ç ES6 imports, –Ω–æ `index.js` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CommonJS require - –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π import

